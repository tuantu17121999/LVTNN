<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quản lý đơn hàng</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="/css/staff.css">
    <link rel="stylesheet" href="/css/app.css">
</head>

<body>
    {{>staff/menufunction}}
    {{{body}}}
    
    <!-- Modal -->
    <div id="cancelModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h5>Lý do huỷ đơn</h5>
                <button class="btn-close" onclick="closeModal()">X</button>
            </div>
            <div class="modal-body">
                <textarea id="cancelReason" rows="4" style="width: 100%;"></textarea>
            </div>
            <div class="modal-footer">
                <button class="btn-submit" onclick="submitCancel()">Gửi</button>
                <button class="btn-close" onclick="closeModal()">Đóng</button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Lấy slideId từ localStorage nếu có
            const savedSlideId = localStorage.getItem('slideId');

            // Nếu có slideId được lưu, hiển thị đúng slide
            if (savedSlideId) {
                showSlide(savedSlideId);
            } else {
                // Nếu không có, hiển thị slide mặc định (slide đầu tiên)
                showSlide('new-orders');
            }
        });
        function showSlide(slideId) {
            const slides = document.querySelectorAll('.slide');
            slides.forEach(slide => slide.classList.remove('active'));
            document.getElementById(slideId).classList.add('active');

            // Lưu slideId vào localStorage
            localStorage.setItem('slideId', slideId);
        }
        function cancelOrder() {
            // Gửi yêu cầu huỷ đơn hàng đến server
            alert('Đơn hàng đã được huỷ!');
        }

        function showDetails() {
            // Hiển thị chi tiết đơn hàng
            alert('Xem chi tiết đơn hàng!');
        }

        function showCancelModal() {
            document.getElementById('cancelModal').classList.add('active');
        }

        function closeModal() {
            document.getElementById('cancelModal').classList.remove('active');
        }
        //chỉ cho phép hiển thị 3 chi tiết đơn hàng, nếu nhiều hơn thì hiển thị ...
        document.addEventListener('DOMContentLoaded', function () {
            var orderCards = document.querySelectorAll('.order-card');

            orderCards.forEach(function (card) {
                var orderItems = card.querySelector('.order-items');
                var items = orderItems.querySelectorAll('li');

                if (items.length > 3) {
                    for (var i = 3; i < items.length; i++) {
                        items[i].style.display = 'none';
                    }
                    var moreItem = document.createElement('li');
                    moreItem.textContent = '...';
                    orderItems.appendChild(moreItem);
                }
            });
        });

        function submitCancel() {
            const reason = document.getElementById('cancelReason').value;
            // Gửi lý do huỷ đơn hàng đến server
            alert('Lý do huỷ: ' + reason);
            closeModal();
        }
        document.getElementById('currentDate').textContent = new Date().toLocaleDateString('vi-VN');
    </script>
</body>

</html>